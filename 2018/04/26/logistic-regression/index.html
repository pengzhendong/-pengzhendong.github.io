<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 3.9.0"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png"><link rel="mask-icon" href="/images/logo.svg" color="#222"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/lib/font-awesome/css/all.min.css"><script id="hexo-configurations">var NexT=window.NexT||{},CONFIG={hostname:"pengzhendong.cn",root:"/",scheme:"Pisces",version:"7.8.0",exturl:!1,sidebar:{position:"left",display:"post",padding:18,offset:12,onmobile:!1},copycode:{enable:!1,show_result:!1,style:null},back2top:{enable:!0,sidebar:!1,scrollpercent:!1},bookmark:{enable:!1,color:"#222",save:"auto"},fancybox:!1,mediumzoom:!1,lazyload:!1,pangu:!1,comments:{style:"tabs",active:null,storage:!0,lazyload:!1,nav:null},algolia:{appID:"39IHYBUVGR",apiKey:"4287c8f8a629343c8d2212e108417ceb",indexName:"Notes",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}},localsearch:{enable:!1,trigger:"auto",top_n_per_article:1,unescape:!1,preload:!1},motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},path:"search.xml"}</script><meta name="description" content="å‰è¨€ æœ€è¿‘åœ¨çœ‹å´æ©è¾¾çš„ DeepLearningï¼Œå­¦ä¹ äº†ä¸å°‘å…³äºæ·±åº¦å­¦ä¹ çš„çŸ¥è¯†ï¼Œæ­£å¥½å‚è€ƒç€ä½œä¸šçš„å†…å®¹æ€»ç»“ä¸€ä¸‹ï¼ŒæŒ–è¿™ä¸ªå‘å¿…é¡»å¾—å¡«ï¼Œå“ˆå“ˆã€‚"><meta name="keywords" content="Machine Learning"><meta property="og:type" content="article"><meta property="og:title" content="Logistic å›å½’å’Œ Softmax å›å½’"><meta property="og:url" content="https://pengzhendong.cn/2018/04/26/logistic-regression/index.html"><meta property="og:site_name" content="Randy&#39;s Notes"><meta property="og:description" content="å‰è¨€ æœ€è¿‘åœ¨çœ‹å´æ©è¾¾çš„ DeepLearningï¼Œå­¦ä¹ äº†ä¸å°‘å…³äºæ·±åº¦å­¦ä¹ çš„çŸ¥è¯†ï¼Œæ­£å¥½å‚è€ƒç€ä½œä¸šçš„å†…å®¹æ€»ç»“ä¸€ä¸‹ï¼ŒæŒ–è¿™ä¸ªå‘å¿…é¡»å¾—å¡«ï¼Œå“ˆå“ˆã€‚"><meta property="og:locale" content="zh-CN"><meta property="og:image" content="https://pengzhendong.cn/2018/04/26/logistic-regression/sigmoid.png"><meta property="og:image" content="https://pengzhendong.cn/2018/04/26/logistic-regression/beta1.png"><meta property="og:image" content="https://pengzhendong.cn/2018/04/26/logistic-regression/beta2.png"><meta property="og:image" content="https://pengzhendong.cn/2018/04/26/logistic-regression/beta3.png"><meta property="og:image" content="https://pengzhendong.cn/2018/04/26/logistic-regression/cost.png"><meta property="og:image" content="https://randy-1251769892.cos.ap-beijing.myqcloud.com/logistic-regression.gif"><meta property="og:updated_time" content="2018-04-26T13:32:11.000Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="Logistic å›å½’å’Œ Softmax å›å½’"><meta name="twitter:description" content="å‰è¨€ æœ€è¿‘åœ¨çœ‹å´æ©è¾¾çš„ DeepLearningï¼Œå­¦ä¹ äº†ä¸å°‘å…³äºæ·±åº¦å­¦ä¹ çš„çŸ¥è¯†ï¼Œæ­£å¥½å‚è€ƒç€ä½œä¸šçš„å†…å®¹æ€»ç»“ä¸€ä¸‹ï¼ŒæŒ–è¿™ä¸ªå‘å¿…é¡»å¾—å¡«ï¼Œå“ˆå“ˆã€‚"><meta name="twitter:image" content="https://pengzhendong.cn/2018/04/26/logistic-regression/sigmoid.png"><link rel="canonical" href="https://pengzhendong.cn/2018/04/26/logistic-regression/"><script id="page-configurations">CONFIG.page={sidebar:"",isHome:!1,isPost:!0,lang:"zh-CN"}</script><style type="text/css">body{background-image:url(/images/rockywall.png)}</style><title>Logistic å›å½’å’Œ Softmax å›å½’ | Randy's Notes</title><script async src="https://www.googletagmanager.com/gtag/js?id=UA-92548519-1"></script><script>if(CONFIG.hostname===location.hostname){function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-92548519-1")}</script><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?06c54470f22c395ef480d6fb358497d5";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-header,.use-motion .comments,.use-motion .menu-item,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript></head><body itemscope itemtype="http://schema.org/WebPage"><div class="container use-motion"><div class="headband"></div><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ "><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span><h1 class="site-title">Randy's Notes</h1><span class="logo-line-after"><i></i></span></a></div><div class="site-nav-right"><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class="site-nav"><ul id="menu" class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i> é¦–é¡µ</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i> å½’æ¡£</a></li><li class="menu-item menu-item-å‹é“¾"><a href="/friends/" rel="section"><i class="fa fa-users fa-fw"></i> å‹é“¾</a></li><li class="menu-item menu-item-ä¹¦å•"><a href="/books/" rel="section"><i class="fa fa-book fa-fw"></i> ä¹¦å•</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i> æœç´¢</a></li></ul></nav><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"></div><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span></div><div class="algolia-results"><div id="algolia-stats"></div><div id="algolia-hits"></div><div id="algolia-pagination" class="algolia-pagination"></div></div></div></div></div></header><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span>0%</span></div> <a href="https://github.com/pengzhendong" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115 130 115 142 142 250 250 250 0Z"></path><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4L133.7 101.6C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8Z" fill="currentColor" class="octo-body"></path></svg></a><main class="main"><div class="main-inner"><div class="content-wrap"><div class="content post posts-expand"><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://pengzhendong.cn/2018/04/26/logistic-regression/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="Randy Peng"><meta itemprop="description" content="è·¯æ¼«æ¼«å…¶ä¿®è¿œå…® å¾å°†ä¸Šä¸‹è€Œæ±‚ç´¢"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Randy's Notes"></span><header class="post-header"><h1 class="post-title" itemprop="name headline"> Logistic å›å½’å’Œ Softmax å›å½’</h1><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i></span> <span class="post-meta-item-text">å‘è¡¨äº</span> <time title="åˆ›å»ºæ—¶é—´ï¼š2018-04-26 20:24:05 / ä¿®æ”¹æ—¶é—´ï¼š21:32:11" itemprop="dateCreated datePublished" datetime="2018-04-26T20:24:05+08:00">2018-04-26</time></span><span id="/2018/04/26/logistic-regression/" class="post-meta-item leancloud_visitors" data-flag-title="Logistic å›å½’å’Œ Softmax å›å½’" title="é˜…è¯»æ¬¡æ•°"><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span> <span class="post-meta-item-text">é˜…è¯»æ¬¡æ•°ï¼š</span><span class="leancloud-visitors-count"></span></span><br><span class="post-meta-item" title="æœ¬æ–‡å­—æ•°"><span class="post-meta-item-icon"><i class="far fa-file-word"></i></span> <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span> <span>0</span></span><span class="post-meta-item" title="é˜…è¯»æ—¶é•¿"><span class="post-meta-item-icon"><i class="far fa-clock"></i></span> <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span> <span>1 åˆ†é’Ÿ</span></span></div></header><div class="post-body" itemprop="articleBody"><h2 id="å‰è¨€">å‰è¨€</h2><p>æœ€è¿‘åœ¨çœ‹å´æ©è¾¾çš„ DeepLearningï¼Œå­¦ä¹ äº†ä¸å°‘å…³äºæ·±åº¦å­¦ä¹ çš„çŸ¥è¯†ï¼Œæ­£å¥½å‚è€ƒç€ä½œä¸šçš„å†…å®¹æ€»ç»“ä¸€ä¸‹ï¼ŒæŒ–è¿™ä¸ªå‘å¿…é¡»å¾—å¡«ï¼Œå“ˆå“ˆã€‚</p><a id="more"></a><p>å‡ ä¹æ‰€æœ‰æ·±åº¦å­¦ä¹ çš„ä¹¦éƒ½æ˜¯ä» <strong>Logistic Regression</strong> å¼€å§‹è®²ï¼Œå› ä¸ºè¿™æ˜¯ä¸€ä¸ªæœ€ç®€å•çš„â€œç¥ç»ç½‘ç»œâ€ã€‚ä»¥å‰çœ‹åˆ°ç½‘ä¸Šæœ‰ä¸å°‘äººæŠŠè¿™ä¸ªè¯ç»„ç¿»è¯‘ä¸ºâ€œé€»è¾‘å›å½’â€ï¼Œä½†æ˜¯çœ‹åˆ°è¥¿ç“œä¹¦ğŸ‰ä¸Šè¯´ logistic != logic ï¼Œä½œè€…æŠŠè¿™ä¸ªç¿»è¯‘ä¸ºå¯¹æ•°å‡ ç‡å›å½’ï¼Œç®€ç§°å¯¹ç‡å›å½’ã€‚å¯¹ç‡å›å½’å¯ä»¥è§£å†³çº¿æ€§äºŒåˆ†ç±»é—®é¢˜ï¼Œæ¨å¹¿æˆ Softmax å›å½’å¯ä»¥è§£å†³çº¿æ€§å¤šåˆ†ç±»é—®é¢˜ã€‚</p><h2 id="logistic-å›å½’">Logistic å›å½’</h2><p>çº¿æ€§å›å½’é¢„æµ‹çš„ y æ˜¯è¿ç»­çš„å€¼ï¼Œå¯¹äºäºŒåˆ†ç±»é—®é¢˜ï¼Œæˆ‘ä»¬å¸Œæœ›é¢„æµ‹çš„ y åªèƒ½å– 0/1 ä¸¤ä¸ªå€¼ã€‚ä¾‹å¦‚å‡è®¾è‚¿ç˜¤æ˜¯å¦æ˜¯æ¶æ€§è‚¿ç˜¤åªå’Œè‚¿ç˜¤çš„å¤§å°æœ‰å…³ï¼Œç„¶åç»™å®šè‚¿ç˜¤çš„å¤§å°ï¼Œåˆ¤æ–­å®ƒæ˜¯å¦æ˜¯æ¶æ€§è‚¿ç˜¤ï¼Œ1 è¡¨ç¤ºæ­£ä¾‹(æ˜¯)ï¼Œ0 è¡¨ç¤ºè´Ÿä¾‹(å¦)ã€‚</p><blockquote><p>åˆ†ç±»æ˜¯ç›‘ç£å­¦ä¹ çš„ä¸€ä¸ªæ ¸å¿ƒé—®é¢˜ï¼Œåœ¨ç›‘ç£å­¦ä¹ ä¸­ï¼Œå½“è¾“å‡ºå˜é‡ Y å–æœ‰é™ä¸ªç¦»æ•£å€¼æ—¶ï¼Œé¢„æµ‹é—®é¢˜ä¾¿æˆä¸ºåˆ†ç±»é—®é¢˜ã€‚è¿™æ—¶ï¼Œè¾“å…¥å˜é‡ X å¯ä»¥æ˜¯ç¦»æ•£çš„ï¼Œä¹Ÿå¯ä»¥æ˜¯è¿ç»­çš„ã€‚ç›‘ç£å­¦ä¹ ä»æ•°æ®ä¸­å­¦ä¹ ä¸€ä¸ªåˆ†ç±»æ¨¡å‹æˆ–åˆ†ç±»å†³ç­–å‡½æ•°ï¼Œç§°ä¸ºåˆ†ç±»å™¨(classifier)ã€‚åˆ†ç±»å™¨å¯¹æ–°çš„è¾“å…¥è¿›è¡Œè¾“å‡ºçš„é¢„æµ‹(prediction)ï¼Œç§°ä¸ºåˆ†ç±»(classification)ã€‚</p></blockquote><p>å¦‚æœä½¿ç”¨çº¿æ€§å›å½’è§£å†³äºŒåˆ†ç±»ä»»åŠ¡ï¼Œå› ä¸ºè¾“å‡ºä¼šæœ‰å¤§äº 1 å’Œå°äº 0 çš„æ•°ï¼Œè§£å†³è¿™ä¸ªé—®é¢˜åªéœ€è¦å°†çº¿æ€§å›å½’çš„é¢„æµ‹å€¼ <span class="math inline">\(h_\boldsymbol{\theta}(\boldsymbol{x})=\boldsymbol{\theta}^ \mathrm{T}\boldsymbol{x}\)</span> æ˜ å°„åˆ°å€¼åŸŸä¸º (0, 1) çš„ç©ºé—´ä¸Šï¼Œå³ï¼š</p><p><span class="math display">\[h_\boldsymbol{\theta}(\boldsymbol{x})=g(\boldsymbol{\theta}^ \mathrm{T}\boldsymbol{x})=\frac{1}{1+e^{-\boldsymbol{\theta}^ \mathrm{T}\boldsymbol{x}}}\]</span></p><p>å› æ­¤ <span class="math inline">\(ln\frac{h_\boldsymbol{\theta}(\boldsymbol{x})}{1-h_\boldsymbol{\theta}(\boldsymbol{x})}=\boldsymbol{\theta}^ \mathrm{T}\boldsymbol{x}\)</span>ï¼Œå®é™…ä¸Šæ˜¯åœ¨ç”¨çº¿æ€§å›å½’æ¨¡å‹çš„é¢„æµ‹ç»“æœå»é€¼è¿‘æ ·æœ¬çœŸå®æ ‡è®°ä¸ºæ­£ä¾‹å’Œåä¾‹çš„å¯èƒ½æ€§çš„æ¯”å€¼ï¼Œå³çœŸå®æ ‡è®°çš„å¯¹æ•°å‡ ç‡ã€‚<span class="math inline">\(g(z)\)</span> ä¹Ÿå«åš <code>Logistic function</code> æˆ–è€… <code>Sigmoid function</code>ã€‚</p><p><img src="/2018/04/26/logistic-regression/sigmoid.png"></p><p>è¯¥å‡½æ•°çš„å¯¼æ•°ä¸ºï¼š</p><p><span class="math display">\[g&#39;(z)=\frac{d}{dz}\frac{1}{1+e^{-z}}=\frac{e^{-z}}{(1+e^{-z})^2}=g(z)\left(1-g(z)\right)\]</span></p><p><span class="math inline">\(z\)</span> è¶‹äºæ­£æ— ç©·æ—¶ï¼Œ<span class="math inline">\(g(z)\)</span> è¶‹äº 1ï¼›<span class="math inline">\(z\)</span> è¶‹äºè´Ÿæ— ç©·æ—¶ï¼Œ<span class="math inline">\(g(z)\)</span> è¶‹äº 0ã€‚</p><p><span class="math inline">\(h_\boldsymbol{\theta}(\boldsymbol{x}) \geq 0.5\)</span> å³ <span class="math inline">\(\boldsymbol{\theta}^\mathrm{T}\boldsymbol{x}\geq0\)</span> è¡¨ç¤ºæ˜¯æ¶æ€§è‚¿ç˜¤çš„å¯èƒ½æ€§å¤§äºç­‰äº 50%ï¼Œå› æ­¤å¯ä»¥ç»™å®šä¸€ä¸ªé˜ˆå€¼ä¾‹å¦‚å°±æ˜¯ 0.5ï¼Œæ¶æ€§è‚¿ç˜¤çš„å¯èƒ½æ€§å¤§äºç­‰äº 50% å°±åˆ¤å®šæ˜¯æ¶æ€§è‚¿ç˜¤ï¼Œå¦åˆ™åˆ¤å®šä¸æ˜¯æ¶æ€§è‚¿ç˜¤ã€‚å³ <span class="math display">\[ y = \begin{cases} 0 &amp; h_\boldsymbol{\theta}(\boldsymbol{x}) &lt; 0.5 \\\ 1 &amp; h_\boldsymbol{\theta}(\boldsymbol{x}) \geq 0.5 \end{cases} \]</span> åœ¨åˆ¤å®šæ˜¯å¦ä¸ºæ¶æ€§è‚¿ç˜¤çš„æ—¶å€™ï¼ŒåŒ»ç”Ÿä¼šæ›´åŠ æ³¨é‡å¬å›ç‡è€Œä¸æ˜¯å‡†ç¡®ç‡ï¼Œâ€œå®å¯æ€é”™ä¹Ÿä¸æ”¾è¿‡â€ï¼Œæ‰€ä»¥é˜ˆå€¼å¯èƒ½ä¼šæ›´å°ä¸€äº›ï¼Œä¾‹å¦‚åªè¦æœ‰ 40% å¯èƒ½æ€§å°±è¦åˆ¤å®šä¸ºæ¶æ€§è‚¿ç˜¤ï¼Œç„¶åè¿›è¡Œæ²»ç–—ã€‚</p><p>åœ¨å¯¹ç‡å›å½’ä¸­å¦‚æœåƒçº¿æ€§å›å½’æ¨¡å‹ä¸€æ ·å°†å¹³æ–¹æŸå¤±ä½œä¸ºæŸå¤±å‡½æ•°ï¼Œé‚£ä¹ˆç›®æ ‡å‡½æ•°ä¸ºï¼š</p><p><span class="math display">\[E_{\theta}=\sum_{i=1}^m(y^{(i)}-\frac{1}{1+e^{-\boldsymbol{\theta}^ \mathrm{T}\boldsymbol{x}^{(i)}}})^2\]</span></p><p>è¿™æ˜¯ä¸€ä¸ªéå‡¸å‡½æ•°ï¼Œä¸å®¹æ˜“æ±‚è§£ï¼Œå®¹æ˜“å¾—åˆ°å±€éƒ¨æœ€ä¼˜å€¼ã€‚åœ¨å¯¹ç‡å›å½’ä¸­ï¼Œç»å¸¸ä½¿ç”¨æœ€å¤§ä¼¼ç„¶çš„æ–¹æ³•ä¼°è®¡æ¨¡å‹çš„å‚æ•°ï¼Œå› æ­¤æŸå¤±å‡½æ•°æ˜¯åŸºäºæœ€å¤§ä¼¼ç„¶ä¼°è®¡æ¨å¯¼å¾—åˆ°çš„å¯¹æ•°ä¼¼ç„¶æŸå¤±å‡½æ•°ã€‚</p><h2 id="ä¸¤å¤§å­¦æ´¾çš„äº‰è®º">ä¸¤å¤§å­¦æ´¾çš„äº‰è®º</h2><p>åœ¨å­¦ä¹ æœ€å¤§ä¼¼ç„¶ä¼°è®¡ä¹‹å‰å…ˆäº†è§£ä¸€ä¸‹é¢‘ç‡å­¦æ´¾å’Œè´å¶æ–¯å­¦æ´¾å¯¹ä¸–ç•Œçš„è®¤çŸ¥ã€‚å¯¹äº‹ç‰©å»ºæ¨¡æ—¶ï¼Œç”¨ <span class="math inline">\(\theta\)</span> è¡¨ç¤ºæ¨¡å‹çš„å‚æ•°ï¼Œè§£å†³é—®é¢˜çš„æœ¬è´¨å°±æ˜¯æ±‚ <span class="math inline">\(\theta\)</span>ã€‚ä¾‹å¦‚é€šè¿‡æŠ›ç¡¬å¸ä¼°è®¡ç¡¬å¸æ­£é¢æœä¸Šçš„æ¦‚ç‡ <span class="math inline">\(P(head)=\theta\)</span>ã€‚</p><p>æ¦‚ç‡å’Œä¼¼ç„¶éƒ½æ˜¯æŒ‡å¯èƒ½æ€§ï¼Œä½†æ˜¯åœ¨ç»Ÿè®¡å­¦ä¸­ï¼Œæ¦‚ç‡å’Œä¼¼ç„¶æœ‰æˆªç„¶ä¸åŒçš„ç”¨æ³•ã€‚</p><ul><li>æ¦‚ç‡ï¼šæè¿°äº†å·²çŸ¥å‚æ•° <span class="math inline">\(\theta\)</span> æ—¶çš„éšæœºå˜é‡çš„è¾“å‡ºç»“æœã€‚ä¾‹å¦‚å·²çŸ¥å‚æ•° <span class="math inline">\(\theta=0.5\)</span> ï¼Œæ±‚æŠ› m æ¬¡ç¡¬å¸å‡ºç° n æ¬¡æ­£é¢æœä¸Šçš„æ¦‚ç‡ã€‚</li><li>ä¼¼ç„¶ï¼šæè¿°å·²çŸ¥éšæœºå˜é‡è¾“å‡ºç»“æœæ—¶ï¼ŒæœªçŸ¥å‚æ•° <span class="math inline">\(\theta\)</span> çš„å¯èƒ½å–å€¼ã€‚ä¾‹å¦‚å·²çŸ¥æŠ› 100 æ¬¡ç¡¬å¸å‡ºç° 50 æ¬¡æ­£é¢æœä¸Šï¼Œæ±‚å‚æ•° <span class="math inline">\(\theta=x\)</span> çš„ä¼¼ç„¶ç¨‹åº¦ã€‚</li></ul><h3 id="é¢‘ç‡å­¦æ´¾">é¢‘ç‡å­¦æ´¾</h3><p>æ ¹æ®éšæœºé‡å¤äº‹ä»¶çš„<strong>é¢‘ç‡</strong>æ¥è€ƒå¯Ÿ<strong>æ¦‚ç‡</strong>ã€‚æŠ› 10 æ¬¡æœ‰ 4 æ¬¡æ­£é¢æœä¸Šï¼Œåˆ™ <span class="math inline">\(\theta=0.4\)</span>ã€‚å½“æ•°æ®é‡è¶‹äºæ— ç©·æ—¶å°±å¯ä»¥å¾—åˆ°ç²¾å‡†çš„ä¼°è®¡ï¼Œå½“ç¼ºä¹æ•°æ®æ—¶åˆ™å¯èƒ½å‡ºç°ä¸¥é‡çš„åå·®(è¿‡æ‹Ÿåˆ)ï¼Œä¾‹å¦‚å¯¹äºä¸€æšå‡åŒ€çš„ç¡¬å¸ï¼ŒæŠ› 10 æ¬¡æœ‰ 10 æ¬¡æ­£é¢æœä¸Š(è¿™ç§æƒ…å†µçš„æ¦‚ç‡æ˜¯ <span class="math inline">\(\frac{1}{2^{10}}\)</span>)ï¼Œé¢‘ç‡å­¦æ´¾ä¼šç›´æ¥ä¼°è®¡ <span class="math inline">\(\theta=1\)</span>ï¼Œç„¶åé¢„æµ‹æŠ›è¿™ä¸ªç¡¬å¸ 100% æ­£é¢æœä¸Šã€‚</p><h3 id="è´å¶æ–¯å­¦æ´¾">è´å¶æ–¯å­¦æ´¾</h3><p>æ ¹æ®å…ˆéªŒ(Prior)æ¦‚ç‡å’Œä¼¼ç„¶å‡½æ•°(Likelihood function)ï¼Œè®¡ç®—åéªŒ(Posterior)æ¦‚ç‡ã€‚</p><p>è´å¶æ–¯å…¬å¼å¦‚ä¸‹ï¼š</p><p><span class="math display">\[P(\theta|X)=\frac{P(X|\theta)P(\theta)}{P(X)}\]</span></p><p>å‡è®¾æŠ› 10 æ¬¡ç¡¬å¸æ˜¯ä¸€æ¬¡å®éªŒï¼Œ<span class="math inline">\(P(X)\)</span> ç›¸å½“äºæ˜¯ä¸€ä¸ªå½’ä¸€åŒ–é¡¹ï¼Œæ‰€ä»¥ <span class="math inline">\(P(\theta|X)\propto{P(X|\theta)P(\theta)}\)</span>ã€‚</p><h4 id="å…ˆéªŒæ¦‚ç‡-ptheta">å…ˆéªŒæ¦‚ç‡ <span class="math inline">\(P(\theta)\)</span></h4><p>è§‚æµ‹åˆ°æ•°æ®ä¹‹å‰ï¼Œä¸€äº›å…³äºå‚æ•° <span class="math inline">\(\theta\)</span> çš„å‡è®¾ï¼Œå³å‚æ•° <span class="math inline">\(\theta\)</span> å–æŸä¸ªå€¼çš„æ¦‚ç‡ã€‚æ‰€ä»¥ <span class="math inline">\(\theta\)</span> æ˜¯ä¸€ä¸ªéšæœºå˜é‡ï¼Œç¬¦åˆä¸€å®šçš„æ¦‚ç‡åˆ†å¸ƒã€‚å½“å…ˆéªŒåˆ†å¸ƒæ˜¯å‡åŒ€åˆ†å¸ƒæ—¶ï¼Œè´å¶æ–¯æ–¹æ³•ç­‰ä»·äºé¢‘ç‡æ–¹æ³•ã€‚ä¸€èˆ¬ä¼¯åŠªåˆ©åˆ†å¸ƒæŠŠå…ˆéªŒåˆ†å¸ƒé€‰æ‹©ä¸º Beta åˆ†å¸ƒï¼Œå› ä¸ºå®ƒæ­£æ¯”äº <span class="math inline">\(\theta\)</span> å’Œ <span class="math inline">\(1-\theta\)</span> çš„å¹‚æŒ‡æ•°ï¼Œé‚£ä¹ˆåéªŒåˆ†å¸ƒå°±ä¼šæœ‰å’Œå…ˆéªŒåˆ†å¸ƒç›¸åŒçš„å‡½æ•°å½¢å¼(å…±è½­æ€§)ï¼Œæ¥ä¸‹æ¥è§‚æµ‹åˆ°æ›´å¤šæ•°æ®æ—¶åéªŒåˆ†å¸ƒå°±å¯ä»¥æ‰®æ¼”å…ˆéªŒåˆ†å¸ƒçš„è§’è‰²(è¯¦æƒ…è§ PRML 2.1.1)ã€‚</p><p>ä¸‹å›¾ä¸º Beta åˆ†å¸ƒçš„å‡½æ•°åˆ†å¸ƒå›¾ï¼Œè¡¨ç¤ºå…³äºå‚æ•° <span class="math inline">\(\theta\)</span> çš„å‡è®¾ã€‚ä¾‹å¦‚æ™®é€šçš„ç¡¬å¸ï¼ŒBeta åˆ†å¸ƒçš„è¶…å‚æ•° a å’Œ b å¯ä»¥å– 10ï¼Œå³æŠ› 20 æ¬¡ç¡¬å¸åº”è¯¥ä¼šæœ‰ 10 æ¬¡æ­£é¢æœä¸Šå’Œ 10 æ¬¡åé¢æœä¸Šã€‚ä»å›¾ä¸­å¯ä»¥çœ‹å‡ºï¼Œå‚æ•° <span class="math inline">\(\theta\)</span> å– 0.5 æ—¶å…ˆéªŒæ¦‚ç‡æœ€å¤§ï¼Œå–å…¶ä»–å€¼æ—¶å…ˆéªŒæ¦‚ç‡æ¯”è¾ƒå°ã€‚</p><blockquote><p>å¯ä»¥ç®€å•åœ°æŠŠå…ˆéªŒæ¦‚ç‡ä¸­çš„è¶…å‚æ•° a å’Œ b åˆ†åˆ«çœ‹å‡º x = 1 å’Œ x = 0 çš„æœ‰æ•ˆè§‚æµ‹æ¬¡æ•°ã€‚</p></blockquote><p><img src="/2018/04/26/logistic-regression/beta1.png"></p><p>å¦‚æœå¯¹å…³äºå‚æ•° <span class="math inline">\(\theta\)</span> çš„å‡è®¾çš„æŠŠæ¡æ›´å¤§ï¼Œå³æŠ› 100 æ¬¡ç¡¬å¸åº”è¯¥ä¼šæœ‰ 50 æ¬¡æ­£é¢æœä¸Šå’Œ 50 æ¬¡åé¢æœä¸Šã€‚é‚£ä¹ˆå‚æ•° <span class="math inline">\(\theta\)</span> å– 0.5 çš„æ¦‚ç‡å°±æ›´å¤§ï¼Œå–å…¶ä»–å€¼çš„æ¦‚ç‡å°±æ›´å°ã€‚</p><p><img src="/2018/04/26/logistic-regression/beta2.png"></p><h4 id="ä¼¼ç„¶å‡½æ•°-pxtheta">ä¼¼ç„¶å‡½æ•° <span class="math inline">\(P(X|\theta)\)</span></h4><p>å‡è®¾å‚æ•° <span class="math inline">\(\theta\)</span> å·²çŸ¥åè§‚æµ‹åˆ°å·²æœ‰æ•°æ®çš„æ¦‚ç‡ï¼Œæ˜¯å…³äºå‚æ•° <span class="math inline">\(\theta\)</span> çš„å‡½æ•°ã€‚ä¾‹å¦‚æŠ› 10 æ¬¡ç¡¬å¸æœ‰ 2 æ¬¡æ­£é¢æœä¸Šï¼Œé‚£ä¹ˆä¼¼ç„¶å‡½æ•°</p><p><span class="math display">\[P(X|\theta)=\binom{10}{2}\theta^2(1-\theta)^8\]</span></p><p>å‡½æ•°å›¾åƒå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œä»å›¾ä¸­å¯ä»¥çœ‹å‡ºï¼Œå‚æ•° <span class="math inline">\(\theta\)</span> å– 0.2 æ—¶ä¼¼ç„¶ç¨‹åº¦æœ€å¤§ï¼Œå–å…¶ä»–å€¼æ—¶ä¼¼ç„¶ç¨‹åº¦æ¯”è¾ƒå°ã€‚</p><p><img src="/2018/04/26/logistic-regression/beta3.png"></p><h4 id="åéªŒæ¦‚ç‡-pthetax">åéªŒæ¦‚ç‡ <span class="math inline">\(P(\theta|X)\)</span></h4><p>é€šè¿‡ä¼¼ç„¶å‡½æ•°ä¿®æ­£åï¼Œå‚æ•° <span class="math inline">\(\theta\)</span> å–æŸä¸ªå€¼çš„æ¦‚ç‡ã€‚å‚æ•° <span class="math inline">\(\theta\)</span> çš„æ¦‚ç‡åˆ†å¸ƒå°±æ˜¯åéªŒåˆ†å¸ƒã€‚</p><p>å¯¹äºå…ˆéªŒåˆ†å¸ƒä¸ºè¶…å‚æ•° a = b = 10 çš„ Beta åˆ†å¸ƒï¼Œä¼¼ç„¶å‡½æ•° <span class="math inline">\(P(X|\theta)=\binom{10}{2}\theta^2(1-\theta)^8\)</span> ï¼Œå¯ä»¥ç®—å‡ºå¯¹åº”çš„åéªŒåˆ†å¸ƒæ˜¯è¶…å‚æ•°ä¸º a = 12ï¼Œb = 18 çš„ Beta åˆ†å¸ƒã€‚</p><blockquote><p>å®šé‡åœ°æè¿°ä¸ç¡®å®šæ€§ï¼Œå¹¶ä¸”æ ¹æ®å°‘é‡æ–°çš„æ•°æ®å¯¹ä¸ç¡®å®šæ€§è¿›è¡Œç²¾ç¡®çš„ä¿®æ”¹ï¼Œå¯¹æ¥ä¸‹æ¥è¦é‡‡å–çš„åŠ¨ä½œè¿›è¡Œä¿®æ”¹ï¼Œæˆ–è€…å¯¹æœ€ç»ˆçš„å†³ç­–è¿›è¡Œä¿®æ”¹ã€‚</p></blockquote><p>åœ¨è´å¶æ–¯å­¦æ´¾å’Œé¢‘ç‡å­¦æ´¾çš„è§‚ç‚¹ä¸­ï¼Œä¼¼ç„¶å‡½æ•°éƒ½èµ·ç€é‡è¦çš„ä½œç”¨ï¼Œç„¶è€Œä½¿ç”¨çš„æ–¹å¼æœ‰ç€æœ¬è´¨çš„ä¸åŒã€‚é¢‘ç‡å­¦å®¶è§‚ç‚¹è®¤ä¸ºå‚æ•° <span class="math inline">\(\theta\)</span> æ˜¯ä¸€ä¸ªå›ºå®šçš„å‚æ•°ï¼Œé¢‘ç‡å­¦æ´¾å¹¿æ³›ä½¿ç”¨æœ€å¤§ä¼¼ç„¶ä¼°è®¡ï¼Œå‚æ•° <span class="math inline">\(\theta\)</span> çš„å€¼å°±æ˜¯ä½¿ä¼¼ç„¶å‡½æ•° <span class="math inline">\(P(X|\theta)\)</span> è¾¾åˆ°æœ€å¤§å€¼çš„ <span class="math inline">\(\theta\)</span> çš„å€¼ï¼›è´å¶æ–¯å­¦æ´¾åˆ™å¹¿æ³›ä½¿ç”¨æœ€å¤§åéªŒä¼°è®¡ï¼Œå‚æ•° <span class="math inline">\(\theta\)</span> çš„å€¼å°±æ˜¯ä½¿åéªŒåˆ†å¸ƒ <span class="math inline">\(P(\theta|X)\propto{P(X|\theta)P(\theta)}\)</span> è¾¾åˆ°æœ€å¤§å€¼çš„ <span class="math inline">\(\theta\)</span> çš„å€¼ã€‚</p><p>è´å¶æ–¯è§‚ç‚¹çš„ä¼˜ç‚¹æ˜¯åŒ…å«äº†å…ˆéªŒæ¦‚ç‡ï¼Œç›¸å½“äºåŠ äº†æ­£åˆ™åŒ–é¡¹ï¼Œé¿å…äº§ç”Ÿè¿‡æ‹Ÿåˆã€‚ä¸€ä¸ªå¸¦æœ‰åˆç†çš„å…ˆéªŒåˆ†å¸ƒçš„è´å¶æ–¯æ–¹æ³•ä¸ä¼šé¢„æµ‹æŠ›ä¸€æšæ™®é€šçš„ç¡¬å¸ä¼š 100% æ­£é¢æœä¸Šï¼Œä½†æ˜¯å¦‚æœå…ˆéªŒåˆ†å¸ƒé€‰æ‹©ä¸å¥½ï¼Œè´å¶æ–¯æ–¹æ³•ä¹Ÿä¼šæœ‰å¾ˆå¤§çš„å¯èƒ½ç»™å‡ºé”™è¯¯çš„ç»“æœã€‚</p><h3 id="æœ€å¤§ä¼¼ç„¶ä¼°è®¡mle">æœ€å¤§ä¼¼ç„¶ä¼°è®¡(MLE)</h3><p>Maximun Likelihood Estimation æ˜¯é¢‘ç‡å­¦æ´¾å¹¿æ³›ç”¨çš„ä¼°è®¡æ–¹æ³•ã€‚å‡è®¾æ•°æ® <span class="math inline">\(X\)</span>æ˜¯ç‹¬ç«‹åŒåˆ†å‘å¸ƒçš„ä¸€ç»„æŠ½æ ·ã€‚é‚£ä¹ˆ MLE å¯¹ <span class="math inline">\(\theta\)</span> çš„ä¼°è®¡æ–¹æ³•å¯ä»¥å¦‚ä¸‹æ¨å¯¼ï¼š <span class="math display">\[ \begin{align} \hat\\theta_{MLE} &amp; = \arg \max P(X;\theta) \\\ &amp; = \arg \min -log P(X;\theta) \end{align} \]</span></p><p>è¿™é‡Œä¹‹æ‰€ä»¥ç”¨ <span class="math inline">\(P(X;\theta)\)</span> è€Œä¸æ˜¯ <span class="math inline">\(P(X|\theta)\)</span> æ˜¯å› ä¸ºé¢‘ç‡å­¦æ´¾è®¤ä¸ºå‚æ•° <span class="math inline">\(\theta\)</span> æ˜¯å›ºå®šçš„å€¼(åªæ˜¯å½“å‰æœªçŸ¥)è€Œä¸æ˜¯éšæœºå˜é‡ã€‚æœ€åè¦ä¼˜åŒ–çš„å‡½æ•°è¢«ç§°ä¸º Negative Log Likelihood (NLL)ã€‚</p><h3 id="æœ€å¤§åéªŒä¼°è®¡map">æœ€å¤§åéªŒä¼°è®¡(MAP)</h3><p>Maximum A Posteriori æ˜¯è´å¶æ–¯å­¦æ´¾å¹¿æ³›ä½¿ç”¨çš„ä¼°è®¡æ–¹æ³•ã€‚å‡è®¾æ•°æ® <span class="math inline">\(X\)</span> æ˜¯ç‹¬ç«‹åŒåˆ†å‘å¸ƒçš„ä¸€ç»„æŠ½æ ·ã€‚é‚£ä¹ˆ MAP å¯¹ <span class="math inline">\(\theta\)</span> çš„ä¼°è®¡æ–¹æ³•å¯ä»¥å¦‚ä¸‹æ¨å¯¼ï¼š <span class="math display">\[ \begin{align} \hat\\theta_{MAP} &amp; = \arg \max P(\theta|X) \\\ &amp; = \arg \min - log P(\theta|X) \\\ &amp; = \arg \min - log P(X|\theta)-log P(\theta)+log P(X) \\\ &amp; = \arg \min - log P(X|\theta)-log P(\theta) \end{align} \]</span></p><p>MLE å’Œ MAP åœ¨ä¼˜åŒ–æ—¶çš„ä¸åŒå°±æ˜¯åœ¨äºå…ˆéªŒé¡¹ <span class="math inline">\(-log P(\theta)\)</span>ã€‚å‡è®¾åœ¨æŸæ¬¡å®éªŒä¸­ï¼Œå…ˆéªŒåˆ†å¸ƒæ˜¯æ ‡å‡†é«˜æ–¯åˆ†å¸ƒï¼Œå³å‚æ•° <span class="math inline">\(\theta\)</span> æ»¡è¶³æ ‡å‡†é«˜æ–¯åˆ†å¸ƒï¼Œåˆ™ <span class="math inline">\(P(\theta) = Ce^{-\frac{\theta^2}{2}}\)</span>ï¼Œ<span class="math inline">\(-log P(\theta) = C + \frac{\theta^2}{2}\)</span>ã€‚æ‰€ä»¥åœ¨ MAP ä¸­é€‰æ‹©æ ‡å‡†é«˜æ–¯åˆ†å¸ƒä½œä¸ºå…ˆéªŒåˆ†å¸ƒæ—¶å°±ç­‰ä»·äºåœ¨ MLE ä¸­é‡‡ç”¨äº† L2 çš„æ­£åˆ™åŒ–é¡¹ã€‚</p><h2 id="ä»£ä»·å‡½æ•°">ä»£ä»·å‡½æ•°</h2><p>ç”±äºæ— æ³•ä½¿ç”¨å‡æ–¹è¯¯å·®ä½œä¸ºä»£ä»·å‡½æ•°ï¼Œæ‰€ä»¥åˆ†æå½“çœŸå®æ ‡ç­¾ä¸º 1 æ—¶ï¼Œæˆ‘ä»¬å¸Œæœ› <span class="math inline">\(h_\boldsymbol{\theta}(\boldsymbol{x})\)</span> å°½å¯èƒ½æ¥è¿‘äº <span class="math inline">\(1^-\)</span> ï¼Œå³ <span class="math inline">\(-log(h_\boldsymbol{\theta}(\boldsymbol{x}))\)</span> å°½å¯èƒ½æ¥è¿‘äº <span class="math inline">\(0^+\)</span>ï¼Œä¹Ÿå°±æ˜¯æœ€å°åŒ–è´Ÿå¯¹æ•°ã€‚</p><p><img src="/2018/04/26/logistic-regression/cost.png"></p><p>åŒç†å¯æ„é€ æŸå¤±å‡½æ•°å¦‚ä¸‹ï¼š</p><p><span class="math display">\[ loss\left(h_\boldsymbol{\theta}(\boldsymbol{x}), y\right) = \begin{cases} -log\left(h_\boldsymbol{\theta}(\boldsymbol{x})\right) &amp; y=1 \\\ -log\left(1-h_\boldsymbol{\theta}(\boldsymbol{x})\right) &amp; y=0 \end{cases} \]</span> åˆå¹¶å¾—æŸå¤±å‡½æ•°ä¸ºï¼š<span class="math inline">\(loss\left(h_\boldsymbol{\theta}(\boldsymbol{x}), y\right)=-ylog\left(h_\boldsymbol{\theta}(\boldsymbol{x})\right)-(1-y)log\left(1-h_\boldsymbol{\theta}(\boldsymbol{x})\right)\)</span></p><p>æ‰€ä»¥å¯¹æ•°ä¼¼ç„¶ä»£ä»·å‡½æ•°ä¸ºï¼š <span class="math display">\[ J(\boldsymbol{\theta}) =-\frac{1}{m}\sum_{i=1}^m\Big(y^{(i)}log\left(h_\boldsymbol{\theta}(\boldsymbol{x}^{(i)})\right)+(1-y^{(i)})log\left(1-h_\boldsymbol{\theta}(\boldsymbol{x}^{(i)})\right)\Big) \]</span> ç”± Sigmoid å‡½æ•°çš„æ€§è´¨å¯çŸ¥ <span class="math inline">\(\frac{\partial{h_\boldsymbol{\theta}(\boldsymbol{x})}}{\partial{\theta_j}}=h_\boldsymbol{\theta}(\boldsymbol{x})(1-h_\boldsymbol{\theta}(\boldsymbol{x}))x_j\)</span> ï¼Œæ‰€ä»¥åœ¨æ¢¯åº¦ä¸‹é™æ±‚æœ€ä¼˜å€¼æ—¶éœ€è¦ç”¨åˆ°çš„æ¢¯åº¦å¯ä»¥æ¨å¯¼ä¸ºï¼š <span class="math display">\[ \begin{align} \nabla_{\theta_j}J(\boldsymbol{\theta}) &amp; = \frac{\partial{J(\boldsymbol{\theta})}}{\partial{\theta_j}} \\\ &amp; = -\frac{1}{m}\sum_{i=1}^m\left(\frac{y^{(i)}}{h_\boldsymbol{\theta}(\boldsymbol{x}^{(i)})}\frac{\partial{h_\boldsymbol{\theta}(\boldsymbol{x}^{(i)})}}{\partial{\theta_j}}-\frac{1-y^{(i)}}{1-h_\boldsymbol{\theta}(\boldsymbol{x}^{(i)})}\frac{\partial{h_\boldsymbol{\theta}(\boldsymbol{x}^{(i)})}}{\partial{\theta_j}}\right) \\\ &amp; = \frac{1}{m}\sum_{i=1}^m\left(h_\boldsymbol{\theta}(\boldsymbol{x}^{(i)})-y^{(i)}\right)x^{(i)}_j \end{align} \]</span> åŒ–ç®€åå‘ç°å’Œçº¿æ€§å›å½’æ¨¡å‹çš„ä»£ä»·å‡½æ•°ä¸€æ ·ã€‚</p><h2 id="softmax-å›å½’">Softmax å›å½’</h2><p>Softmax å›å½’æ˜¯å¯¹ç‡å›å½’çš„æ¨å¹¿ï¼Œå½“ç±»åˆ«æ•° K=2 çš„æ—¶å€™ï¼ŒSoftmax å›å½’é€€åŒ–ä¸ºå¯¹ç‡å›å½’ã€‚ç”±äºåœ¨æ¨¡å‹ä¸­ä½¿ç”¨äº† Softmax å‡½æ•°ï¼Œæ¯”è¾ƒæ¸©å’Œ(soft)åœ°è¾“å‡ºæ ·æœ¬å±äºå„ä¸ªç±»åˆ«çš„æ¦‚ç‡ï¼Œè€Œä¸æ˜¯ç›´æ¥æœ€å¯èƒ½å±äºçš„ç±»åˆ«ï¼Œå› æ­¤å«åš Softmax å›å½’ã€‚</p><p>Softmax å‡½æ•°æˆ–ç§°<strong>å½’ä¸€åŒ–æŒ‡æ•°å‡½æ•°</strong>ï¼Œæ˜¯ Sigmoid å‡½æ•°çš„ä¸€ç§æ¨å¹¿ã€‚å®ƒèƒ½å°†ä¸€ä¸ªå«ä»»æ„å®æ•°çš„ K ç»´å‘é‡ <span class="math inline">\(\boldsymbol{z}\)</span>Â â€œå‹ç¼©â€åˆ°å¦ä¸€ä¸ª K ç»´å®å‘é‡ <span class="math inline">\(\sigma(\boldsymbol{z})\)</span> ä¸­ï¼Œä½¿å¾—æ¯ä¸€ä¸ªå…ƒç´ çš„èŒƒå›´éƒ½åœ¨ (0, 1) ä¹‹é—´ï¼Œå¹¶ä¸”æ‰€æœ‰å…ƒç´ çš„å’Œä¸º 1ã€‚è¯¥å‡½æ•°çš„å½¢å¼é€šå¸¸æŒ‰ä¸‹é¢çš„å¼å­ç»™å‡ºï¼š <span class="math display">\[ \sigma(\boldsymbol{z})=\frac{1}{\sum_{i=1}^ke^{z_i}}\begin{bmatrix} e^{z_1} \\\ e^{z_2} \\\ ... \\\ e^{z_k} \end{bmatrix}\quad \]</span> Softmax å›å½’æ¨¡å‹å¯¹äºè¯¸å¦‚ MNIST æ‰‹å†™æ•°å­—åˆ†ç±»ç­‰é—®é¢˜å¾ˆæœ‰ç”¨ã€‚å¯¹äºäºŒåˆ†ç±»é—®é¢˜ï¼Œç±»æ ‡è®° <span class="math inline">\(y\in\lbrace0, 1\rbrace\)</span>ï¼›è€Œåœ¨ K(K &gt; 2) åˆ†ç±»é—®é¢˜ä¸­åˆ™æ˜¯ <span class="math inline">\(y\in\lbrace1, 2, â€¦, k\rbrace\)</span>ã€‚ä¾‹å¦‚ï¼Œåœ¨ MNIST æ•°å­—è¯†åˆ«ä»»åŠ¡ä¸­ï¼Œ10 ä¸ªæ•°å­—å¯¹åº” K=10 ä¸ªä¸åŒçš„ç±»åˆ«ã€‚</p><p>å¯¹ç‡å›å½’çš„å‡è®¾å‡½æ•° <span class="math inline">\(h_\boldsymbol{\theta}(\boldsymbol{x})=g(\boldsymbol{\theta}^ \mathrm{T}\boldsymbol{x})=\frac{1}{1+e^{-\boldsymbol{\theta}^ \mathrm{T}\boldsymbol{x}}}\)</span> è®¡ç®—çš„æ˜¯æ ·æœ¬å±äºæ­£ä¾‹çš„æ¦‚ç‡ï¼Œç”±äºåªæœ‰ä¸¤ç±»ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥æ ¹æ®é˜ˆå€¼è¿›è¡Œåˆ¤æ–­ã€‚è€Œ Softmax å›å½’åˆ™éœ€è¦è¾“å‡ºä¸€ä¸ª K ç»´å‘é‡(å…ƒç´ å’Œä¸º 1ï¼Œ<strong>å½’ä¸€åŒ–</strong>)æ¥è¡¨ç¤ºæ ·æœ¬å±äºæ¯ä¸ªç±»çš„æ¦‚ç‡ï¼Œå› æ­¤éœ€è¦çš„æ¨¡å‹å‚æ•°ä¹Ÿå°±æ›´å¤šã€‚æœ€ååˆ¤æ–­å±äºå“ªä¸€ç±»æ—¶åˆ™å¯ä»¥å–æœ€å¤§çš„æ¦‚ç‡å€¼å¯¹åº”çš„ç±»åˆ«ã€‚ <span class="math display">\[ h_\boldsymbol{\Theta}(\boldsymbol{x})=\begin{bmatrix} p(y=1|\boldsymbol{x};\boldsymbol{\Theta}) \\\ p(y=2|\boldsymbol{x};\boldsymbol{\Theta}) \\\ ... \\\ p(y=k|\boldsymbol{x};\boldsymbol{\Theta}) \end{bmatrix}=\frac{1}{\sum_{i=1}^ke^{\boldsymbol{\theta}^\mathrm{T}_i\boldsymbol{x}}}\begin{bmatrix} e^{\boldsymbol{\theta}^\mathrm{T}_1\boldsymbol{x}} \\\ e^{\boldsymbol{\theta}^\mathrm{T}_2\boldsymbol{x}} \\\ ... \\\ e^{\boldsymbol{\theta}^\mathrm{T}_k\boldsymbol{x}} \end{bmatrix}\quad å…¶ä¸­ \boldsymbol{\Theta}=\begin{bmatrix} -\boldsymbol{\theta}^\mathrm{T}_1- \\\ -\boldsymbol{\theta}^\mathrm{T}_2- \\\ ... \\\ -\boldsymbol{\theta}^\mathrm{T}_k- \end{bmatrix} \]</span></p><h3 id="ä»£ä»·å‡½æ•°-1">ä»£ä»·å‡½æ•°</h3><blockquote><p>ç¤ºæ€§å‡½æ•°ï¼š1{å€¼ä¸ºçœŸçš„è¡¨è¾¾å¼} = 1</p></blockquote><p>å¯¹æ•°ä¼¼ç„¶ä»£ä»·å‡½æ•° <span class="math inline">\(J(\boldsymbol{\theta}) =-\frac{1}{m} \sum_{i=1}^m(y^{(i)}log(h_\boldsymbol{\theta}(\boldsymbol{x}^{(i)}))+(1-y^{(i)})log(1-h_\boldsymbol{\theta}(\boldsymbol{x}^{(i)})))\)</span> å¯ä»¥æ¨å¹¿ä¸ºï¼š <span class="math display">\[ J(\boldsymbol{\Theta}) =-\frac{1}{m}\sum_{i=1}^m\sum_{j=0}^11\lbrace y^{(i)}=j\rbrace logp(y^{(i)}=j|\boldsymbol{x}^{(i)};\boldsymbol{\Theta}) \]</span> å’Œå¯¹æ•°ä¾ç„¶ä¸€æ ·å¯ä»¥ç†è§£ä¸ºå½“çœŸå®æ ‡ç­¾ä¸º j æ—¶ï¼Œè¦è®©é¢„æµ‹ä¸º j ç±»çš„æ¦‚ç‡å€¼ <span class="math inline">\(p(y^{(i)}=j|\boldsymbol{x}^{(i)};\boldsymbol{\Theta})\)</span> å°½å¯èƒ½æ¥è¿‘ <span class="math inline">\(1^-\)</span>ã€‚å› æ­¤ Softmax å›å½’çš„ä»£ä»·å‡½æ•°ä¸ºï¼š <span class="math display">\[ J(\boldsymbol{\Theta}) =-\frac{1}{m}\sum_{i=1}^m\sum_{j=1}^k1\lbrace y^{(i)}=j\rbrace log\frac{e^{\boldsymbol{\theta}\_j^\mathrm{T}\boldsymbol{x}^{(i)}}}{\sum_{l=1}^ke^{\boldsymbol{\theta}^\mathrm{T}_l\boldsymbol{x}^{(i)}}} \]</span></p><p>è®¡ç®—æ¢¯åº¦å…¬å¼å¦‚ä¸‹ï¼š <span class="math display">\[ \begin{align} \frac{\partial{J(\boldsymbol{\Theta})}}{\partial{\boldsymbol{\theta}\_j}} = -\frac{1}{m} \sum_{i=1}^m\left(\boldsymbol{x}^{(i)}(1\lbrace y^{(i)}=j\rbrace-\frac{e^{\boldsymbol{\theta}\_j^\mathrm{T}\boldsymbol{x}^{(i)}}}{\sum_{l=1}^ke^{\boldsymbol{\theta}^\mathrm{T}_l\boldsymbol{x}^{(i)}}})\right) \end{align} \]</span></p><p>åœ¨ä½¿ç”¨ä¸­ä¸€èˆ¬ä¼šæ·»åŠ æƒé‡è¡°å‡é¡¹(æ­£åˆ™é¡¹) <span class="math inline">\(\frac{\lambda}{2}\sum_{i=1}^k\sum_{j=0}^n\theta^2_{ij}\)</span> æƒ©ç½šè¿‡å¤§çš„å‚æ•°å€¼ï¼Œå…¶åœ¨ <span class="math inline">\(\theta_j\)</span> æ–¹å‘ä¸Šçš„æ¢¯åº¦ä¸º <span class="math inline">\(\lambda\theta_j\)</span>ã€‚</p><h2 id="ç¥ç»ç½‘ç»œ">* ç¥ç»ç½‘ç»œ</h2><blockquote><p>ç¥ç»ç½‘ç»œä¸­æœ€åŸºæœ¬çš„æˆåˆ†æ˜¯ç¥ç»å…ƒæ¨¡å‹ï¼Œåœ¨ç”Ÿç‰©ç¥ç»ç½‘ç»œæ˜¯ï¼Œæ¯ä¸ªç¥ç»å…ƒä¸å…¶ä»–ç¥ç»å…ƒç›¸è¿ï¼Œå½“å®ƒâ€œå…´å¥‹â€æ—¶ï¼Œå°±ä¼šå‘ç›¸è¿çš„ç¥ç»å…ƒå‘é€åŒ–å­¦ç‰©è´¨ï¼Œä»è€Œæ”¹å˜è¿™äº›ç¥ç»å…ƒå†…çš„ç”µä½ï¼›å¦‚æœæŸç¥ç»å…ƒçš„ç”µä½è¶…è¿‡äº†ä¸€ä¸ªâ€œé˜ˆå€¼â€ï¼Œé‚£ä¹ˆå®ƒå°±ä¼šè¢«æ¿€æ´»ï¼Œå³â€œå…´å¥‹â€èµ·æ¥ï¼Œå‘å…¶ä»–ç¥ç»å…ƒå‘é€åŒ–å­¦ç‰©è´¨ã€‚</p></blockquote><p>æ ¹æ®ç¥ç»å…ƒçš„å®šä¹‰ï¼Œå¯ä»¥å°†å¯¹ç‡å›å½’çœ‹æˆæ˜¯ä¸€ä¸ªå¾ˆç®€å•çš„ç¥ç»ç½‘ç»œæ¨¡å‹ã€‚å³åªæœ‰è¾“å…¥å±‚å’Œè¾“å‡ºå±‚ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º(æ¥è‡ª<a href="http://playground.tensorflow.org/#activation=sigmoid&amp;batchSize=10&amp;dataset=gauss&amp;regDataset=reg-gauss&amp;learningRate=0.03&amp;regularizationRate=0&amp;noise=40&amp;networkShape=&amp;seed=0.49707&amp;showTestData=false&amp;discretize=false&amp;percTrainData=50&amp;x=true&amp;y=true&amp;xTimesY=false&amp;xSquared=false&amp;ySquared=false&amp;cosX=false&amp;sinX=false&amp;cosY=false&amp;sinY=false&amp;collectStats=false&amp;problem=classification&amp;initZero=false&amp;hideText=false&amp;stepButton_hide=false&amp;noise_hide=false" target="_blank" rel="noopener">Tensorflow</a>)ï¼š</p><figure> <img src="https://randy-1251769892.cos.ap-beijing.myqcloud.com/logistic-regression.gif" alt="Logistic regression"><figcaption aria-hidden="true">Logistic regression</figcaption></figure><p>æœ‰éšè—å±‚çš„ç¥ç»ç½‘ç»œçš„è¾“å‡ºå±‚å°±æ˜¯ä¸€ä¸ªå¯¹ç‡å›å½’ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªçº¿æ€§åˆ†ç±»å™¨ã€‚è¾“å…¥å±‚å’Œä¸­é—´çš„éšè—å±‚å¯ä»¥çœ‹æˆç‰¹å¾æå–çš„è¿‡ç¨‹ï¼Œå°±æ˜¯æŠŠå¯¹ç‡å›å½’çš„è¾“å‡ºå½“ä½œç‰¹å¾ï¼Œç„¶åå†å°†å®ƒé€å…¥ä¸‹ä¸€ä¸ªå¯¹ç‡å›å½’ï¼Œä¸€å±‚å±‚å˜æ¢ã€‚ç”±äºæ¿€æ´»å‡½æ•°æ˜¯éçº¿æ€§å‡½æ•°ï¼Œæ‰€ä»¥é€šè¿‡ç‰¹å¾æå–ï¼Œå°±å¯ä»¥æŠŠåŸæœ¬çº¿æ€§ä¸å¯åˆ†çš„æ•°æ®å˜å¾—çº¿æ€§å¯åˆ†ã€‚</p><h2 id="å‚è€ƒæ–‡çŒ®">å‚è€ƒæ–‡çŒ®</h2><p>[1] å‘¨å¿—å. æœºå™¨å­¦ä¹ . æ¸…åå¤§å­¦å‡ºç‰ˆç¤¾. 2016.</p><p>[2] å´æ©è¾¾. DeepLearning.</p><p>[3] Ian Goodfellow, Yoshua Bengio, Aaron Courville. Deep Learning. äººæ°‘é‚®ç”µå‡ºç‰ˆç¤¾. 2017.</p><p>[4] Stephen Boyd, Lieven Vandenberghe. å‡¸ä¼˜åŒ–. æ¸…åå¤§å­¦å‡ºç‰ˆç¤¾. 2017.</p><p>[5] Christopher M.Bishop. Pattern Recognition and Machine Learning. 2006.</p></div><div class="reward-container"><div>ç–å½±æ¨ªæ–œæ°´æ¸…æµ…ï¼Œæš—é¦™æµ®åŠ¨æœˆé»„æ˜</div> <button onclick='var qr=document.getElementById("qr");qr.style.display="none"===qr.style.display?"block":"none"'> æ‰“èµ</button><div id="qr" style="display:none"><div style="display:inline-block"> <img src="/images/wechatpay.png" alt="Randy Peng å¾®ä¿¡æ”¯ä»˜"><p>å¾®ä¿¡æ”¯ä»˜</p></div><div style="display:inline-block"> <img src="/images/alipay.png" alt="Randy Peng æ”¯ä»˜å®"><p>æ”¯ä»˜å®</p></div></div></div><div><ul class="post-copyright"><li class="post-copyright-author"> <strong>æœ¬æ–‡ä½œè€…ï¼š</strong> Randy Peng</li><li class="post-copyright-link"> <strong>æœ¬æ–‡é“¾æ¥ï¼š</strong> <a href="https://pengzhendong.cn/2018/04/26/logistic-regression/" title="Logistic å›å½’å’Œ Softmax å›å½’">https://pengzhendong.cn/2018/04/26/logistic-regression/</a></li><li class="post-copyright-license"> <strong>ç‰ˆæƒå£°æ˜ï¼š</strong> æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i> BY-NC-SA</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼</li></ul></div><center><br><div class="addthis_inline_share_toolbox"><script src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5aa9d6309315fb5e" async="async"></script></div></center><footer class="post-footer"><div class="post-tags"> <a href="/tags/Machine-Learning/" rel="tag"># Machine Learning</a></div><div class="post-nav"><div class="post-nav-item"><a href="/2018/03/10/linear-regression/" rel="prev" title="çº¿æ€§å›å½’"><i class="fa fa-chevron-left"></i> çº¿æ€§å›å½’</a></div><div class="post-nav-item"> <a href="/2018/05/19/neuron-network/" rel="next" title="å•éšå±‚ç¥ç»ç½‘ç»œ">å•éšå±‚ç¥ç»ç½‘ç»œ<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script></div><div class="toggle sidebar-toggle"><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div><aside class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc"> æ–‡ç« ç›®å½•</li><li class="sidebar-nav-overview"> ç«™ç‚¹æ¦‚è§ˆ</li></ul><div class="post-toc-wrap sidebar-panel"><div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#å‰è¨€"><span class="nav-number">1.</span> <span class="nav-text">å‰è¨€</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#logistic-å›å½’"><span class="nav-number">2.</span> <span class="nav-text">Logistic å›å½’</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ä¸¤å¤§å­¦æ´¾çš„äº‰è®º"><span class="nav-number">3.</span> <span class="nav-text">ä¸¤å¤§å­¦æ´¾çš„äº‰è®º</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#é¢‘ç‡å­¦æ´¾"><span class="nav-number">3.1.</span> <span class="nav-text">é¢‘ç‡å­¦æ´¾</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#è´å¶æ–¯å­¦æ´¾"><span class="nav-number">3.2.</span> <span class="nav-text">è´å¶æ–¯å­¦æ´¾</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#å…ˆéªŒæ¦‚ç‡-ptheta"><span class="nav-number">3.2.1.</span> <span class="nav-text">å…ˆéªŒæ¦‚ç‡ \(P(\theta)\)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ä¼¼ç„¶å‡½æ•°-pxtheta"><span class="nav-number">3.2.2.</span> <span class="nav-text">ä¼¼ç„¶å‡½æ•° \(P(X|\theta)\)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#åéªŒæ¦‚ç‡-pthetax"><span class="nav-number">3.2.3.</span> <span class="nav-text">åéªŒæ¦‚ç‡ \(P(\theta|X)\)</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#æœ€å¤§ä¼¼ç„¶ä¼°è®¡mle"><span class="nav-number">3.3.</span> <span class="nav-text">æœ€å¤§ä¼¼ç„¶ä¼°è®¡(MLE)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#æœ€å¤§åéªŒä¼°è®¡map"><span class="nav-number">3.4.</span> <span class="nav-text">æœ€å¤§åéªŒä¼°è®¡(MAP)</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ä»£ä»·å‡½æ•°"><span class="nav-number">4.</span> <span class="nav-text">ä»£ä»·å‡½æ•°</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#softmax-å›å½’"><span class="nav-number">5.</span> <span class="nav-text">Softmax å›å½’</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#ä»£ä»·å‡½æ•°-1"><span class="nav-number">5.1.</span> <span class="nav-text">ä»£ä»·å‡½æ•°</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ç¥ç»ç½‘ç»œ"><span class="nav-number">6.</span> <span class="nav-text">* ç¥ç»ç½‘ç»œ</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#å‚è€ƒæ–‡çŒ®"><span class="nav-number">7.</span> <span class="nav-text">å‚è€ƒæ–‡çŒ®</span></a></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" alt="Randy Peng" src="/images/avatar.jpg"><p class="site-author-name" itemprop="name">Randy Peng</p><div class="site-description" itemprop="description">è·¯æ¼«æ¼«å…¶ä¿®è¿œå…® å¾å°†ä¸Šä¸‹è€Œæ±‚ç´¢</div></div><div class="site-state-wrap motion-element"><nav class="site-state"><div class="site-state-item site-state-posts"> <a href="/archives/"><span class="site-state-item-count">34</span> <span class="site-state-item-name">æ—¥å¿—</span></a></div><div class="site-state-item site-state-tags"> <a href="/tags/"><span class="site-state-item-count">7</span> <span class="site-state-item-name">æ ‡ç­¾</span></a></div></nav></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/pengzhendong" title="GitHub â†’ https://github.com/pengzhendong" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i> GitHub</a></span><span class="links-of-author-item"><a href="https://twitter.com/pengzhendong" title="Twitter â†’ https://twitter.com/pengzhendong" rel="noopener" target="_blank"><i class="fab fa-twitter fa-fw"></i> Twitter</a></span><span class="links-of-author-item"><a href="mailto:275331498@qq.com" title="E-Mail â†’ mailto:275331498@qq.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i> E-Mail</a></span><span class="links-of-author-item"><a href="https://www.facebook.com/pengzhendong" title="FaceBook â†’ https://www.facebook.com/pengzhendong" rel="noopener" target="_blank"><i class="fab fa-facebook fa-fw"></i> FaceBook</a></span><span class="links-of-author-item"><a href="https://t.me/pengzhendong" title="Telegram â†’ https://t.me/pengzhendong" rel="noopener" target="_blank"><i class="fab fa-telegram fa-fw"></i> Telegram</a></span><span class="links-of-author-item"><a href="https://www.zhihu.com/people/pengzhendong" title="çŸ¥ä¹ â†’ https://www.zhihu.com/people/pengzhendong" rel="noopener" target="_blank"><i class="fab fa-leanpub fa-fw"></i> çŸ¥ä¹</a></span><span class="links-of-author-item"><a href="https://weibo.com/qq275331498" title="å¾®åš â†’ https://weibo.com/qq275331498" rel="noopener" target="_blank"><i class="fab fa-weibo fa-fw"></i> å¾®åš</a></span><span class="links-of-author-item"><a href="/about" target="_self" title="å…³äº â†’ /about" target="_self"><i class="fa fa-user fa-fw"></i> å…³äº</a></span></div><hr style="margin-top:20px;margin-bottom:20px"> <img src="/images/wechat.png"></div></div></aside><div id="sidebar-dimmer"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright"> &copy; 2015 â€“ <span itemprop="copyrightYear">2021</span><span class="with-love"><i class="fa fa-heart"></i></span> <span class="author" itemprop="copyrightHolder">Randy Peng</span> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-chart-area"></i></span> <span title="ç«™ç‚¹æ€»å­—æ•°">258k</span> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-coffee"></i></span> <span title="ç«™ç‚¹é˜…è¯»æ—¶é•¿">3:55</span></div><script>
  (function() {
    function leancloudSelector(url) {
      url = encodeURI(url);
      return document.getElementById(url).querySelector('.leancloud-visitors-count');
    }

    function addCount(Counter) {
      var visitors = document.querySelector('.leancloud_visitors');
      var url = decodeURI(visitors.id);
      var title = visitors.dataset.flagTitle;

      Counter('get', '/classes/Counter?where=' + encodeURIComponent(JSON.stringify({ url })))
        .then(response => response.json())
        .then(({ results }) => {
          if (results.length > 0) {
            var counter = results[0];
            leancloudSelector(url).innerText = counter.time + 1;
            Counter('put', '/classes/Counter/' + counter.objectId, { time: { '__op': 'Increment', 'amount': 1 } })
              .catch(error => {
                console.error('Failed to save visitor count', error);
              });
          } else {
              leancloudSelector(url).innerText = 'Counter not initialized! More info at console err msg.';
              console.error('ATTENTION! LeanCloud counter has security bug, see how to solve it here: https://github.com/theme-next/hexo-leancloud-counter-security. \n However, you can still use LeanCloud without security, by setting `security` option to `false`.');
            
          }
        })
        .catch(error => {
          console.error('LeanCloud Counter Error', error);
        });
    }

    function showTime(Counter) {
      var visitors = document.querySelectorAll('.leancloud_visitors');
      var entries = [...visitors].map(element => {
        return decodeURI(element.id);
      });

      Counter('get', '/classes/Counter?where=' + encodeURIComponent(JSON.stringify({ url: { '$in': entries } })))
        .then(response => response.json())
        .then(({ results }) => {
          for (let url of entries) {
            let target = results.find(item => item.url === url);
            leancloudSelector(url).innerText = target ? target.time : 0;
          }
        })
        .catch(error => {
          console.error('LeanCloud Counter Error', error);
        });
    }

    let { app_id, app_key, server_url } = {"enable":true,"app_id":"YHMwvrTgcfDjOXmiGY3jQ2r5-gzGzoHsz","app_key":"JRfKfM8mRPgxMB9GOSAnix9W","server_url":null,"security":true};
    function fetchData(api_server) {
      var Counter = (method, url, data) => {
        return fetch(`${api_server}/1.1${url}`, {
          method,
          headers: {
            'X-LC-Id'     : app_id,
            'X-LC-Key'    : app_key,
            'Content-Type': 'application/json',
          },
          body: JSON.stringify(data)
        });
      };
      if (CONFIG.page.isPost) {
        if (CONFIG.hostname !== location.hostname) return;
        addCount(Counter);
      } else if (document.querySelectorAll('.post-title-link').length >= 1) {
        showTime(Counter);
      }
    }

    let api_server = app_id.slice(-9) !== '-MdYXbMMI' ? server_url : `https://${app_id.slice(0, 8).toLowerCase()}.api.lncldglobal.com`;

    if (api_server) {
      fetchData(api_server);
    } else {
      fetch('https://app-router.leancloud.cn/2/route?appId=' + app_id)
        .then(response => response.json())
        .then(({ api_server }) => {
          fetchData('https://' + api_server);
        });
    }
  })();
</script></div></footer></div><script src="/lib/anime.min.js"></script><script src="/lib/velocity/velocity.min.js"></script><script src="/lib/velocity/velocity.ui.min.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/pisces.js"></script><script src="/js/next-boot.js"></script><script>!function(){var o,n,e=document.getElementsByTagName("link");if(0<e.length)for(i=0;i<e.length;i++)"canonical"==e[i].rel.toLowerCase()&&e[i].href&&(o=e[i].href);n=o?o.split(":")[0]:window.location.protocol.split(":")[0],o||(o=window.location.href),function(){var e=o,i=document.referrer;if(!/([http|https]:\/\/[a-zA-Z0-9\_\.]+\.baidu\.com)/gi.test(e)){var t="https"===String(n).toLowerCase()?"https://sp0.baidu.com/9_Q4simg2RQJ8t7jm9iCKT-xh_/s.gif":"//api.share.baidu.com/s.gif";i?(t+="?r="+encodeURIComponent(document.referrer),e&&(t+="&l="+e)):e&&(t+="?l="+e),(new Image).src=t}}(window)}()</script><script src="//cdn.jsdelivr.net/npm/algoliasearch@4/dist/algoliasearch-lite.umd.js"></script><script src="//cdn.jsdelivr.net/npm/instantsearch.js@4/dist/instantsearch.production.min.js"></script><script src="/js/algolia-search.js"></script><script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script></body></html>